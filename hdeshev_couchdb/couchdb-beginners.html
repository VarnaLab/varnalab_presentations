<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CouchDB за начинаещи<br/>Христо Дешев - @hdeshev</title>
    <!-- Styles -->
    
    <style type="text/css" media="print">
      * {
    margin: 0;
    padding: 0;
}
@page {
    size: landscape;
}
body {
    font: 100% "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
    padding: 0;
    margin: 0;
}
div.slide {
    min-width: 800px;
    min-height: 600px;
    padding: 1em;
    overflow: hidden;
    page-break-after: always;
    border: 1px solid black;
    border-radius: 20px;
}
div.slide div.inner {
    width: 800px;
    height: 600px;
    margin: auto;
    display: table-cell;
}
h1 {
    font-size: 2.4em;
}
h2 {
    font-size: 1.4em;
}
h3 {
    margin: 1em 0;
}
ul {
    margin: 0;
    padding: 0;
}
p, li, pre {
    margin: 1em 0;
}
li {
    margin-left: 2em;
}
a {
    color: #000000;
}
pre, code {
    max-width: 800px;
    background: #eee;
    font-family: Monaco, monospace;
    font-size: 90%;
}
pre {
    padding: .2em .5em;
    overflow: hidden;
    border-radius: .8em;
}
code {
    padding: 0 .2em;
}
.slide header:only-child h1 {
  line-height: 180%;
  text-align: center;
  display: table-cell;
  vertical-align: middle;
  height: 600px;
  width: 800px;
  font-size: 48px;
  margin-top:100px;
  margin-bottom:100px;
}
#toc, #help, .slide aside, .slide footer, .slide .notes {
  display: none;
}

    </style>
    <style type="text/css" media="screen, projection">
      body {
  font: 14px "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
  background: #778;
  padding: 0;
  margin: 0;
  overflow: hidden;
}

div.presentation {
  position: absolute;
  width: 100%;
  display: table-cell;
  vertical-align: middle;
  height: 100%;
  background: inherit;
}

div.slides {
  width: 100%;
  height: 100%;
  overflow: hidden;
  left: 0;
  top: 0;
  position: absolute;
  display: block;
  -webkit-transition: -webkit-transform 1s ease-in-out;
  -moz-transition: -moz-transform 1s ease-in-out;
  -o-transition: -o-transform 1s ease-in-out;
}

div.slide {
  display: none;
  position: absolute;
  overflow: hidden;
  width: 900px;
  height: 700px;
  left: 50%;
  top: 50%;
  margin-top: -350px;
  background: -webkit-gradient(linear, left bottom, left top, from(#bbd), to(#fff));
  background-color: #eee;
  background: -moz-linear-gradient(bottom, #bbd, #fff);
  -webkit-transition: margin 0.25s ease-in-out;
  -moz-transition: margin 0.25s ease-in-out;
  -o-transition: margin 0.25s ease-in-out;
  border-top-left-radius: 20px;
  -moz-border-radius-topleft: 20px;
  -webkit-border-top-left-radius: 20px;
  border-top-right-radius: 20px;
  -moz-border-radius-topright: 20px;
  -webkit-border-top-right-radius: 20px;
  border-bottom-right-radius: 20px;
  -moz-border-radius-bottomright: 20px;
  -webkit-border-bottom-right-radius: 20px;
  border-bottom-left-radius: 20px;
  -moz-border-radius-bottomleft: 20px;
  -webkit-border-bottom-left-radius: 20px;
}

div.slide p {
  font-size: 20px;
}

.slide.far-past {
  display: block;
  margin-left: -2400px;
}

.slide.past {
  display: block;
  margin-left: -1400px;
}

.slide.current {
  display: block;
  margin-left: -450px;
}

.slide.future {
  display: block;
  margin-left: 500px;
}

.slide.far-future {
  display: block;
  margin-left: 1500px;
}

body.three-d div.slides {
  -webkit-transform: translateX(50px) scale(0.8) rotateY(10deg);
  -moz-transform: translateX(50px) scale(0.8) rotateY(10deg);
  -o-transform: translateX(50px) scale(0.8) rotateY(10deg);
}


/* Content */

header:not(:only-child) {
  font-family: 'Lucida Grande';
  font-weight: normal;
  font-size: 50px;
  letter-spacing: -.05em;
  color: white;
  color: black;
  text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
  position: absolute;
  left: 30px;
  top: 25px;
  margin: 0;
  padding: 0;
}

header h1, header h2 {
  display: inline;
  font-size: 100%;
  font-weight: normal;
  padding: 0;
  margin: 0;
}

header h2:first-child {
  margin-top: 0;
}

section, .slide header:only-child h1 {
  font-family: 'Lucida Grande';
  color: #3f3f3f;
  text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
  margin-left: 30px;
  margin-right: 30px;
  margin-top: 100px;
  display: block;
  overflow: hidden;
}

a {
  color: inherit;
  display: inline-block;
  text-decoration: none;
  line-height: 110%;
  border-bottom: 2px solid #3f3f3f;
}

pre {
  font-size: 16px;
  font-family: Monaco, Courier, monospace;
}

li {
  padding: 10px 0;
  font-size: 20px;
}

.slide header:only-child h1 {
  line-height: 180%;
  text-align: center;
  display: table-cell;
  vertical-align: middle;
  height: 700px;
  width: 900px;
  font-size: 50px;
  margin-top:100px;
  margin-bottom:100px;
}

.sidebar {
  background: -webkit-gradient(linear, top right, bottom right, from(#dde), to(#fff));
  -webkit-transition: margin 0.25s ease-in-out;
  background-color: #eee;
  background: -moz-linear-gradient(right, #dde, #fff);
  border-right: 5px solid #ccd;
  z-index: 9999999;
  height: 100%;
  overflow: hidden;
  top: 0;
  position: absolute;
  display: block;
  margin: 0;
  margin-left: -400px;
  padding: 10px 16px;
  overflow: auto;
  -webkit-transition: margin 0.2s ease-in-out;
  -moz-transition: margin 0.2s ease-in-out;
  -o-transition: margin 0.2s ease-in-out;
}

.sidebar h2 {
  text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
  margin: 0 0 16px;
  padding: 0;
}

.sidebar table {
  width: 100%;
  margin: 0;
  padding: 0;
  border-collapse: collapse;
}

.sidebar table caption {
  display: none;
}

.sidebar tr {
  margin: 2px 0;
  border-bottom: 1px solid #ccc;
}

.sidebar th {
  text-align: left;
  font-weight: normal;
  max-width: 300px;
  overflow: hidden;
}

.sidebar tr.sub th {
  text-indent: 20px;
}

.sidebar td {
  text-align: right;
  min-width: 20px;
}

.sidebar a {
  display: block;
  text-decoration: none;
  border-bottom: none;
  padding: 4px 0;
}

.sidebar tr.active {
  background: #ff0;
}

aside {
  display: none;
}
  aside.source {
    position: absolute;
    bottom: 6px;
    left: 10px;
    text-indent: 10px;
  }
  aside.page_number {
    position: absolute;
    bottom: 6px;
    right: 10px;
    text-indent: 10px;
  }

.notes {
  display: none;
  padding: 10px;
  background: #ccc;
  border-radius: 10px;
  -moz-border-radius: 10px;
  -webkit-border-radius: 10px;
}
  div.slide p.notes {
    font-size: 90%;
}

/* Pygments default theme */
.hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cp { color: #BC7A00 } /* Comment.Preproc */
.c1 { color: #408080; font-style: italic } /* Comment.Single */
.cs { color: #408080; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #808080 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0040D0 } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #7D9029 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.il { color: #666666 } /* Literal.Number.Integer.Long */

    </style>
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script>
      function main() {
  // Since we don't have the fallback of attachEvent and
  // other IE only stuff we won't try to run JS for IE.
  // It will run though when using Google Chrome Frame
  if (document.all) { return; }

  var currentSlideNo;
  var notesOn = false;
  var slides = document.getElementsByClassName('slide');
  var touchStartX = 0;
  var spaces = /\s+/, a1 = [""];
  var tocOpened = false;
  var helpOpened = false;

  var str2array = function(s) {
    if (typeof s == "string" || s instanceof String) {
      if (s.indexOf(" ") < 0) {
        a1[0] = s;
        return a1;
      } else {
        return s.split(spaces);
      }
    }
    return s;
  };

  var trim = function(str) {
    return str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
  };

  var addClass = function(node, classStr) {
    classStr = str2array(classStr);
    var cls = " " + node.className + " ";
    for (var i = 0, len = classStr.length, c; i < len; ++i) {
      c = classStr[i];
      if (c && cls.indexOf(" " + c + " ") < 0) {
        cls += c + " ";
      }
    }
    node.className = trim(cls);
  };

  var removeClass = function(node, classStr) {
    var cls;
    if (classStr !== undefined) {
      classStr = str2array(classStr);
      cls = " " + node.className + " ";
      for (var i = 0, len = classStr.length; i < len; ++i) {
        cls = cls.replace(" " + classStr[i] + " ", " ");
      }
      cls = trim(cls);
    } else {
      cls = "";
    }
    if (node.className != cls) {
      node.className = cls;
    }
  };

  var getSlideEl = function(slideNo) {
    if (slideNo > 0) {
      return slides[slideNo - 1];
    } else {
      return null;
    }
  };

  var getSlideTitle = function(slideNo) {
    var el = getSlideEl(slideNo);
    if (el) {
      var headers = el.getElementsByTagName('header');
      if (headers.length > 0) {
        return el.getElementsByTagName('header')[0].innerText;
      }
    }
    return null;
  };

  var changeSlideElClass = function(slideNo, className) {
    var el = getSlideEl(slideNo);
    if (el) {
      removeClass(el, 'far-past past current future far-future');
      addClass(el, className);
    }
  };

  var updateSlideClasses = function() {
    window.location.hash = "slide" + currentSlideNo;

    for (var i=1; i<currentSlideNo-1; i++) {
      changeSlideElClass(i, 'far-past');
    }

    changeSlideElClass(currentSlideNo - 1, 'past');
    changeSlideElClass(currentSlideNo, 'current');
    changeSlideElClass(currentSlideNo + 1, 'future');

    for (var i=currentSlideNo+2; i<slides.length+1; i++) {
      changeSlideElClass(i, 'far-future');
    }

    highlightCurrentTocLink();

    document.getElementsByTagName('title')[0].innerText = getSlideTitle(currentSlideNo);
  };

  var highlightCurrentTocLink = function() {
    var tocRows = document.getElementById('toc').getElementsByTagName('tr');
    for (var i=0; i<tocRows.length; i++) {
      removeClass(tocRows.item(i), 'active');
    }

    var currentTocRow = document.getElementById('toc-row-' + currentSlideNo);
    if (currentTocRow) {
      addClass(currentTocRow, 'active');
    }
  }

  var nextSlide = function() {
    if (currentSlideNo < slides.length) {
      currentSlideNo++;
    }
    updateSlideClasses();
  };

  var prevSlide = function() {
    if (currentSlideNo > 1) {
      currentSlideNo--;
    }
    updateSlideClasses();
  };

  var showNotes = function() {
    var notes = getSlideEl(currentSlideNo).getElementsByClassName('notes');
    for (var i = 0, len = notes.length; i < len; i++) {
      notes.item(i).style.display = (notesOn) ? 'none':'block';
    }
    notesOn = (notesOn) ? false : true;
  };

  var showSlideNumbers = function() {
    var asides = document.getElementsByClassName('page_number');
    var hidden = asides[0].style.display != 'block';
    for (var i = 0; i < asides.length; i++) {
      asides.item(i).style.display = hidden ? 'block' : 'none';
    }
  };

  var showSlideSources = function() {
    var asides = document.getElementsByClassName('source');
    var hidden = asides[0].style.display != 'block';
    for (var i = 0; i < asides.length; i++) {
      asides.item(i).style.display = hidden ? 'block' : 'none';
    }
  };

  var showToc = function() {
    if (helpOpened) {
        showHelp();
    }

    var toc = document.getElementById('toc');

    toc.style.marginLeft = tocOpened ? '-400px' : '0px';

    tocOpened = !tocOpened;
  };

  var showHelp = function() {
    var help = document.getElementById('help');

    help.style.marginLeft = helpOpened ? '-400px' : '0px';

    helpOpened = !helpOpened;
  };

  var switch3D = function() {
    if (document.body.className.indexOf('three-d') == -1) {
      document.getElementsByClassName('presentation')[0].style.webkitPerspective = '1000px';
      document.body.className += ' three-d';
    } else {
      window.setTimeout("document.getElementsByClassName('presentation')[0].style.webkitPerspective = '0';", 2000);
      document.body.className = document.body.className.replace(/three-d/, '');
    }
  };

  var handleBodyKeyDown = function(event) {
    switch (event.keyCode) {
      case 37: // left arrow
        prevSlide();
        break;
      case 39: // right arrow
      case 32: // space
        nextSlide();
        break;
      case 50: // 2
        showNotes();
        break;
      case 51: // 3
        switch3D();
        break;
      case 72: // h
        showHelp();
        break;
      case 78: // n
        showSlideNumbers();
        break;
      case 83: // s
        showSlideSources();
        break;
      case 84: // t
        showToc();
        break;
    }
  };

  var handleWheel = function(event) {
    if (tocOpened || helpOpened) {
      return;
    }

    var delta = 0;

    if (!event) {
      event = window.event;
    }

    if (event.wheelDelta) {
      delta = event.wheelDelta/120;
      if (window.opera) delta = -delta;
    } else if (event.detail) {
      delta = -event.detail/3;
    }

    if (delta && delta <0) {
      nextSlide();
    } else if (delta) {
      prevSlide();
    }
  };

  var addTouchListeners = function() {
    document.addEventListener('touchstart', function(e) {
      touchStartX = e.touches[0].pageX;
    }, false);
    document.addEventListener('touchend', function(e) {
      var pixelsMoved = touchStartX - e.changedTouches[0].pageX;
      var SWIPE_SIZE = 150;
      if (pixelsMoved > SWIPE_SIZE) {
        nextSlide();
      }
      else if (pixelsMoved < -SWIPE_SIZE) {
       prevSlide();
      }
    }, false);
  };

  var addTocLinksListeners = function() {
    var tocLinks = document.getElementById('toc').getElementsByTagName('a');
    for (var i=0; i < tocLinks.length; i++) {
      tocLinks.item(i).addEventListener('click', function(e) {
        currentSlideNo = Number(this.attributes['href'].value.replace('#slide', ''));
        updateSlideClasses();
        return false;
      }, true);
    }
  };

  // initialize

  (function() {
    if (window.location.hash != "") {
      currentSlideNo = Number(window.location.hash.replace('#slide', ''));
    } else {
      currentSlideNo = 1;
    }

    document.addEventListener('keydown', handleBodyKeyDown, false);
    document.addEventListener('DOMMouseScroll', handleWheel, false);
    window.onmousewheel = document.onmousewheel = handleWheel

    var els = slides;
    for (var i = 0, el; el = els[i]; i++) {
      addClass(el, 'slide far-future');
    }
    updateSlideClasses();

    // add support for finger events (filter it by property detection?)
    addTouchListeners();

    addTocLinksListeners();
  })();
};

    </script>
    
    <!-- /Javascripts -->
</head>
<body>
  <div class="presentation">
    <div class="slides">
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>CouchDB за начинаещи<br/>Христо Дешев - @hdeshev</h1></header>
          
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            1/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Кратка разходка из NoSQL света</h1></header>
          
          
          <section><ul>
<li>Key-Value stores</li>
<li>Document DBs</li>
<li>BigTable clones</li>
<li>Graph DBs, etc</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            2/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Къде се вписва CouchDB</h1></header>
          
          
          <section><ul>
<li>документна база</li>
<li>MapReduce изгледи</li>
<li>акцент върху лесна репликация и offline работа</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            3/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>NoSQL - "за" и "против"</h1></header>
          
          
          <section><ul>
<li>Добри решения за <strong>специфични</strong> проблеми.</li>
<li>Не са панацея</li>
</ul>
<p><u><strong>Ако някой твърди обратното, то той се опитва да ви продаде нещо!</strong></u></p></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            4/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Къде "блести" CouchDB</h1></header>
          
          
          <section><ul>
<li>документите са със свободна структура и не се налага да ги дефинираме предварително.</li>
<li>гъвкави и странни схеми за индексиране на данни: MapReduce изгледите го позволяват.</li>
<li>протоколът за комуникация е "обикновен" HTTP</li>
<li>репликацията е номер 1 - git за бази данни.</li>
<li>солидно, durable, съхранение на данните [1]<ul>
<li>защита от сривове</li>
<li>лесен бекъп</li>
</ul>
</li>
</ul>
<p>[1] Тъжно е, че изтъкваме такова предимство, но уточнението се налага!</p></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            5/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>База, която "говори" HTTP</h1></header>
          
          
          <section><ul>
<li>бързо и лесно се пишат клиентски библиотеки (драйвери) за всякакви езици</li>
<li>лесно се скриптира: <strong>curl</strong></li>
<li>HTTP кеширане: ETag</li>
<li>Лесна администрация и всевъзможни фокуси с проксита - nginx и други</li>
</ul>
<p>Лесно програмиране! Няма постоянна връзка или "сесия" към базата. Това ни освобождава от грижата да инициализираме сесия към базата от всяка нишкa.</p></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            6/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>REST API</h1></header>
          
          
          <section><p>Всяко важно нещо си има URL.</p>
<ul>
<li>GET</li>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            7/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>MVCC - версии на документи</h1></header>
          
          
          <section><ul>
<li>всеки документ има свойство _id и го адресираме чрез него</li>
<li>отделно имаме и свойство _rev (версия).</li>
<li>всяка промяна на документ изисква _id и _rev.</li>
<li>ако редактираме стари данни (някой е записал по-нова от нашата версия), редакцията пропада.</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            8/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Дизайн документи</h1></header>
          
          
          <section><ul>
<li>Специални документи. </li>
<li>id &rarr; <em>_design/something</em></li>
<li>Kоито могат да съдържат код или друга служебна информация.</li>
<li>Например MapReduce изгледи</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            9/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>MapReduce увод</h1></header>
          
          
          <section><p>Трансформация в две стъпки:</p>
<ul>
<li>Map: документ &rArr; (ключ, стойност)*</li>
<li>Reduce: (ключ, стойности) &rArr; стойност</li>
</ul>
<p>Map трансформацията може да върне повече от една стойност.</p>
<p>Резултатът от Reduce може да се подаде отново на Reduce.</p></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            10/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide has_code">
        <div class="inner">
          
          <header><h1>Изгледи само с Map трансформация</h1></header>
          
          
          <section><p>Удобни за търсене по определено свойство: дата, имейл, и др.</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">){</span>
<span class="lineno">2</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s2">&quot;Account&quot;</span><span class="p">){</span>
<span class="lineno">3</span>     <span class="nx">emit</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span>
<span class="lineno">4</span>   <span class="p">}</span>
<span class="lineno">5</span> <span class="p">}</span>
</pre></div>

<p>http://localhost:5984/myapp/_design/accounts/_view/by_email?key=john@example.com</p></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            11/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Повече от един резултат</h1></header>
          
          
          <section><ul>
<li>
<p>Данните в изгледите са сортирани по ключ.</p>
</li>
<li>
<p>Ключът може да е произволен JSON обект.</p>
</li>
<li>
<p><em>[2011, 10]</em> &lt; <em>[2011, 10, 17]</em> - удобно за взимане на данни за цял ден, месец и т.н.</p>
<p>/blog/_design/docs/_view/by_date?startkey=[2011, 10]&amp;endkey=[2011, 11]</p>
</li>
<li>
<p>Много други трикове!</p>
</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            12/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide has_code">
        <div class="inner">
          
          <header><h1>Reduce - агрегация и още много</h1></header>
          
          
          <section><p>Map функция:</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2</span>   <span class="k">if</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">tags</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3</span>     <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">tags</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">4</span>       <span class="nx">emit</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">tags</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">);</span>
<span class="lineno">5</span>     <span class="p">}</span>
<span class="lineno">6</span>   <span class="p">}</span>
<span class="lineno">7</span> <span class="p">}</span>
</pre></div>

<p>Reduce функция:</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="kd">function</span><span class="p">(</span><span class="nx">keys</span><span class="p">,</span> <span class="nx">values</span><span class="p">,</span> <span class="nx">rereduce</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2</span>     <span class="k">return</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">values</span><span class="p">);</span>
<span class="lineno">3</span> <span class="p">}</span>
</pre></div>
</section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            13/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>MapReduce - демонстрация</h1></header>
          
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            14/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Репликация</h1></header>
          
          
          <section><p>Пространство:</p>
<ul>
<li>eднопосочна</li>
<li>двупосочна</li>
</ul>
<p>Време:</p>
<ul>
<li>еднократна/периодична</li>
<li>постоянна</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            15/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Репликация - демонстрация</h1></header>
          
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            16/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Attachments - файлове в базата</h1></header>
          
          
          <section><ul>
<li>Лесни за съхранение</li>
<li>Директно сервирани от CouchDB<ul>
<li>трябва да ги предпазим от неоторизиран достъп</li>
<li><strong>nginx</strong> + <em>X-Accell-Redirect</em> хедър</li>
</ul>
</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            17/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>CouchApps - приложения в базата</h1></header>
          
          
          <section><ul>
<li>Кодът (JavaScript) се записва като в базата като дизайн документ:<ul>
<li>show</li>
<li>list</li>
<li>validate</li>
<li>update</li>
</ul>
</li>
<li>Статичните файлове (html, css, js, jpg и др.) се записват като attachments.</li>
<li>API за достъп до данните (JQuery-базирано)</li>
<li>Има инструменти за по-лесна разработка: <a href="http://couchapp.org/">CouchApp.org</a></li>
<li>Елементарен deployment: репликация!</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            18/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Ограничения на CouchDB</h1></header>
          
          
          <section><ul>
<li>няма [лесни] ad-hoc заявки</li>
<li>трудно триене на много данни<ul>
<li><em>DELETE FROM history WHERE fromDate &lt; X</em> &larr; <strong>невъзможно</strong></li>
<li>внимавайте с нуждата от често триене, защото тя поражда фрагментация и нужда от compact-ване</li>
</ul>
</li>
<li>изгледите не се обновяват автоматично, а при поискване<ul>
<li>параметри: stale=ok, stale=update_after</li>
</ul>
</li>
<li>compact-ване на файла на базата и изгледите.<ul>
<li>за щастие лесно се автоматизира и не изисква downtime.</li>
<li>в някои случаи, исторически данни например, може да се избегне<ul>
<li>различни бази за различни периоди + триене на старите бази</li>
</ul>
</li>
</ul>
</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            19/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Ресурси</h1></header>
          
          
          <section><ul>
<li><em>CouchDB the Definitive Guide</em> - цяла книга достъпна безплатно онлайн: <a href="http://guide.couchdb.org">guide.couchdb.org</a> </li>
<li><em>Scaling CouchDB</em> - книжле с трикове за мащабни инсталации.</li>
<li>IRC: <strong>#couchdb</strong> на freenode.org мрежата. Винаги има добри хора, които да помогнат.</li>
</ul></section>
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            20/21
          </aside>
        </footer>
      </div>
      
      <!-- slide source: couchdb-beginners.md -->
      <div class="slide">
        <div class="inner">
          
          <header><h1>Въпроси?</h1></header>
          
          
        </div>
        <footer>
          
          <aside class="source">
            Source: <a href="file:///home/hristo/w/couchdb-beginners/couchdb-beginners.md">couchdb-beginners.md</a>
          </aside>
          
          <aside class="page_number">
            21/21
          </aside>
        </footer>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
            
      <tr id="toc-row-1">
        <th><a href="#slide1">CouchDB за начинаещи<br/>Христо Дешев - @hdeshev</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
            
      <tr id="toc-row-2">
        <th><a href="#slide2">Кратка разходка из NoSQL света</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
            
      <tr id="toc-row-3">
        <th><a href="#slide3">Къде се вписва CouchDB</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
            
      <tr id="toc-row-4">
        <th><a href="#slide4">NoSQL - "за" и "против"</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
            
      <tr id="toc-row-5">
        <th><a href="#slide5">Къде "блести" CouchDB</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
            
      <tr id="toc-row-6">
        <th><a href="#slide6">База, която "говори" HTTP</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
            
      <tr id="toc-row-7">
        <th><a href="#slide7">REST API</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
            
      <tr id="toc-row-8">
        <th><a href="#slide8">MVCC - версии на документи</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
            
      <tr id="toc-row-9">
        <th><a href="#slide9">Дизайн документи</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
            
      <tr id="toc-row-10">
        <th><a href="#slide10">MapReduce увод</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
            
      <tr id="toc-row-11">
        <th><a href="#slide11">Изгледи само с Map трансформация</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
            
      <tr id="toc-row-12">
        <th><a href="#slide12">Повече от един резултат</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
            
      <tr id="toc-row-13">
        <th><a href="#slide13">Reduce - агрегация и още много</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
            
      <tr id="toc-row-14">
        <th><a href="#slide14">MapReduce - демонстрация</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
            
      <tr id="toc-row-15">
        <th><a href="#slide15">Репликация</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
            
      <tr id="toc-row-16">
        <th><a href="#slide16">Репликация - демонстрация</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
            
      <tr id="toc-row-17">
        <th><a href="#slide17">Attachments - файлове в базата</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
            
      <tr id="toc-row-18">
        <th><a href="#slide18">CouchApps - приложения в базата</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
            
      <tr id="toc-row-19">
        <th><a href="#slide19">Ограничения на CouchDB</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
            
      <tr id="toc-row-20">
        <th><a href="#slide20">Ресурси</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
            
      <tr id="toc-row-21">
        <th><a href="#slide21">Въпроси?</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>